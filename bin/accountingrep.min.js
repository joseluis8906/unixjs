accountingrep=(function(){var a;function b(){Gwt.Gui.Window.call(this,"Reporte");this.SetSize(640,320);this.SetPosition(Gwt.Gui.WIN_POS_CENTER);this.SetBorderSpacing(12);this.Rpc=new Gwt.Core.Rpc("/accountingrep/");this.Records;this.EnableMenu();this.AddMenuItem(Gwt.Core.Contrib.Images+"appbar.printer.svg","Imprimir",this.Print.bind(this));this.AddMenuItem(Gwt.Core.Contrib.Images+"appbar.power.svg","Salir",function(){window.gcontrol.open()},Gwt.Gui.MENU_QUIT_APP);this.layout=new Gwt.Gui.VBox();this.SetLayout(this.layout);this.ReportType=new Gwt.Gui.IconSelectBox(Gwt.Core.Contrib.Images+"appbar.notification.star.svg","Tipo de Reporte",[{Text:"Comprobante de Diario",Value:"Daily"}]);this.layout.Add(this.ReportType);this.labelDateBegin=new Gwt.Gui.StaticText("Desde");this.labelDateBegin.SetExpand(true);this.layout.Add(this.labelDateBegin);this.dateBegin=new Gwt.Gui.Date("Inicio");this.dateBegin.Now();this.layout.Add(this.dateBegin);this.labelDateEnd=new Gwt.Gui.StaticText("Hasta");this.labelDateBegin.SetExpand(true);this.layout.Add(this.labelDateEnd);this.dateEnd=new Gwt.Gui.Date("Final");this.dateEnd.Now();this.layout.Add(this.dateEnd);this.Report=null}b.prototype=new Gwt.Gui.Window();b.prototype.constructor=b;b.prototype._App=function(){this.labelDateBegin._StaticText();this.dateBegin._Date();this.labelDateEnd._StaticText();this.dateEnd._Date();this.Report===null?null:this.Report.close();this.layout._VBox();this.labelDateBegin=null;this.dateBegin=null;this.labelDateEnd=null;this.dateEnd=null;this.layout=null;this.Report=null};b.prototype.CreateData=function(){var c={Method:this.ReportType.GetText(),DateBegin:this.dateBegin.GetText(),DateEnd:this.dateEnd.GetText()};return c};b.prototype.Print=function(){var c=this.CreateData();this.Rpc.Send(c,this.PrintResponse.bind(this))};b.prototype.PrintResponse=function(c){var e=(c.DisbVous instanceof Array)?c.DisbVous:[];var d=(c.Accounts instanceof Array)?c.Accounts:[]};b.prototype.ReportLoad=function(){var f=this.Report.contentWindow.document;var c=0;var e=0;for(var d=0;d<this.Records.length;d++){f.getElementById("Code"+d).textContent=this.Records[d].Code;f.getElementById("Name"+d).textContent=this.Records[d].Name;f.getElementById("Partial"+d).textContent=(this.Records[d].Partial===0)?"":this.Records[d].Partial;f.getElementById("Debit"+d).textContent=(this.Records[d].Debit===0)?"":this.Records[d].Debit;f.getElementById("Credit"+d).textContent=(this.Records[d].Credit===0)?"":this.Records[d].Credit;c+=Number(this.Records[d].Debit);e+=Number(this.Records[d].Credit)}f.getElementById("EqSumDebit").textContent=Gwt.Core.Contrib.TextToMonetary(c.toString());f.getElementById("EqSumCredit").textContent=Gwt.Core.Contrib.TextToMonetary(e.toString());f=undefined;this.Report=null;this.Reset()};b.prototype.Reset=function(){this.ReportType.SetText("");this.dateBegin.Now();this.dateEnd.Now()};b.prototype.SortData=function(h){var c=[];var k=[];var m=[];var d;for(var f=0;f<h.length;f++){if(Number(h[f].Debit)!==0){c.push(h[f]);d="Debit"}else{if(Number(h[f].Credit)!==0){k.push(h[f]);d="Credit"}else{if(d=="Debit"){c.push(h[f])}else{k.push(h[f])}}}}var n=[];var g=[];var l=false;for(var f=0;f<c.length;f++){l=true;for(var e=0;e<n.length;e++){if(c[f].Code===n[e].Code){n[e].Partial+=c[f].Partial;n[e].Debit+=c[f].Debit;l=false}}if(l==true){n.push(c[f])}}for(var f=0;f<k.length;f++){l=true;for(var e=0;e<g.length;e++){if(k[f].Code===g[e].Code){g[e].Partial+=k[f].Partial;g[e].Credit+=k[f].Credit;l=false}}if(l==true){g.push(k[f])}}n.sortbykey("Code");g.sortbykey("Code");return m.concat(n.concat(g))};return new function(){this.open=function(){if(a===undefined){a=new b();a.Open()}else{console.log("%app yet opened".replace("%app",a.__proto__.constructor.name))}};this.close=function(){if(a!==undefined){a.Close();a=undefined}}}})();