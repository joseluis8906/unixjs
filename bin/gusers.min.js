gusers=(function(){var a;function b(){Gwt.Gui.Window.call(this,"Usuarios");this.SetSize(320,548);this.SetPosition(Gwt.Gui.WIN_POS_CENTER);this.SetBorderSpacing(12);this.Rpc=new Gwt.Core.Rpc("/gusers/");this.EnableMenu();this.AddMenuItem(Gwt.Core.Contrib.Images+"appbar.cabinet.in.svg","Guardar",this.Insert.bind(this));this.AddMenuItem(Gwt.Core.Contrib.Images+"appbar.refresh.svg","Actualizar",this.Update.bind(this));this.AddMenuItem(Gwt.Core.Contrib.Images+"appbar.delete.svg","Eliminar",this.Delete.bind(this));this.AddMenuItem(Gwt.Core.Contrib.Images+"appbar.power.svg","Salir",function(){window.gcontrol.open()},Gwt.Gui.MENU_QUIT_APP);this.Layout=new Gwt.Gui.VBox();this.Layout.SetAlignment(Gwt.Gui.ALIGN_CENTER);this.SetLayout(this.Layout);this.Avatar=new Gwt.Gui.Avatar("Avatar","jpg",480,480,this.Upload.bind(this));this.Avatar.SetSizeEditor(this.GetAvailableWidth(),this.GetAvailableHeight());this.Title=new Gwt.Gui.StaticText("Datos:");this.UserName=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.user.tie.svg","Usuario");this.Password=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.lock.svg","Contraseña");this.Password.ChangeToPassword();this.Password.SetMaxLength(4);this.DocType=new Gwt.Gui.IconSelectBox(Gwt.Core.Contrib.Images+"appbar.notification.star.svg","Tipo de Documento",[{Text:"Tarjeta de Identidad",Value:"T.I"},{Text:"Cédula de Ciudadanía",Value:"C.C"},{Text:"Registro Civil",Value:"R.C"},{Text:"Cédula Extranjera",Value:"C.E"},{Text:"Pasaporte",Value:"PS"},{Text:"Libreta Militar",Value:"L.M"}]);this.DocNum=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.notification.svg","Número de Documento");this.Country=new Gwt.Gui.IconSelectBox(Gwt.Core.Contrib.Images+"appbar.globe.svg","País",Gwt.Core.Contrib.COUNTRIES_ISO);this.Name=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.user.svg","Nombre");this.LastName=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.user.add.svg","Apellidos");this.Phone=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.phone.svg","Teléfono");this.Email=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.at.svg","Correo Electrónico");this.Address=new Gwt.Gui.IconEntry(Gwt.Core.Contrib.Images+"appbar.home.location.round.svg","Dirección de Residencia");this.Layout.Add(this.Avatar);this.Layout.Add(this.Title);this.Layout.Add(this.UserName);this.Layout.Add(this.Password);this.Layout.Add(this.DocType);this.Layout.Add(this.DocNum);this.Layout.Add(this.Country);this.Layout.Add(this.Name);this.Layout.Add(this.LastName);this.Layout.Add(this.Phone);this.Layout.Add(this.Email);this.Layout.Add(this.Address);this.UserName.SetTabIndex(1);this.Password.SetTabIndex(2);this.DocType.SetTabIndex(3);this.DocNum.SetTabIndex(4);this.Country.SetTabIndex(5);this.Name.SetTabIndex(6);this.LastName.SetTabIndex(7);this.Phone.SetTabIndex(8);this.Email.SetTabIndex(9);this.Address.SetTabIndex(10);this.Add(this.Avatar.GetEditor());this.UserName.AddEvent(Gwt.Gui.Event.Keyboard.KeyUp,this.Select.bind(this))}b.prototype=new Gwt.Gui.Window();b.prototype.constructor=b;b.prototype._App=function(){this.Avatar._Avatar();this.Title._StaticText();this.UserName._IconEntry();this.Password._IconEntry();this.DocType._IconSelectBox();this.DocNum._IconEntry();this.Country._IconSelectBox();this.Name._IconEntry();this.LastName._IconEntry();this.Phone._IconEntry();this.Email._IconEntry();this.Address._IconEntry();this.Layout._VBox();this.Avatar=null;this.Title=null;this.UserName=null;this.Password=null;this.DocType=null;this.DocNum=null;this.Country=null;this.Name=null;this.LastName=null;this.Phone=null;this.Email=null;this.Address=null;this.Layout=null};b.prototype.Upload=function(c){var d=new Gwt.Core.Rpc("/media/");d.Send({Method:"Insert",UserName:"root",FileName:this.Avatar.GetFileName(),Type:this.Avatar.GetType()},this.PreUploadResponse.bind(this))};b.prototype.PreUploadResponse=function(c){if(c.Result===1){this.Avatar.SetName(c.Name);new Gwt.Core.Upload(this.Avatar,this.UploadResponse.bind(this))}};b.prototype.UploadResponse=function(c){if(c.Result!==1){var d=new Gwt.Core.Rpc("/media/");d.Send({Method:"Delete",Name:this.Avatar.GetName(),Type:this.Avatar.GetType()})}};b.prototype.Select=function(c){if(c.keyCode===Gwt.Gui.Event.Keyboard.KeyCodes.Enter){this.Rpc.Send({Method:"Select",UserName:this.UserName.GetText()},this.SelectResponse.bind(this))}};b.prototype.SelectResponse=function(c){if(c.length>0){this.DocType.SetText(c[0].DocumentType);this.DocNum.SetText(c[0].DocumentNum);this.Country.SetText(c[0].Country);this.Name.SetText(c[0].Name);this.LastName.SetText(c[0].LastName);this.Phone.SetText(c[0].Phone);this.Email.SetText(c[0].Email);this.Address.SetText(c[0].Address);this.Avatar.SetName(c[0].AvatarName);this.Avatar.SetType(c[0].AvatarType);this.Avatar.SetImage("/images/"+c[0].AvatarName+"."+c[0].AvatarType)}else{this.Reset()}};b.prototype.Insert=function(){var c={Method:"Insert",UserName:this.UserName.GetText(),Password:this.Password.GetText(),DocumentType:this.DocType.GetText(),DocumentNum:this.DocNum.GetText(),Country:this.Country.GetText(),Name:this.Name.GetText(),LastName:this.LastName.GetText(),Phone:this.Phone.GetText(),Email:this.Email.GetText(),Address:this.Address.GetText(),AvatarName:this.Avatar.GetName(),AvatarType:this.Avatar.GetType()};this.Rpc.Send(c,this.InsertResponse.bind(this))};b.prototype.InsertResponse=function(c){if(c.affected_rows===1){this.Reset()}else{console.log("Error: inserting new user");var d=new Gwt.Core.Rpc("/media/");d.Send({Method:"Delete",Name:this.Avatar.GetName(),Type:this.Avatar.GetType()})}};b.prototype.Update=function(){var c=new Gwt.Core.Rpc("/media/");c.Send({Method:"Update",UserName:this.UserName.GetText(),Name:this.Avatar.GetName(),Type:this.Avatar.GetType()},this.UpdateData.bind(this))};b.prototype.UpdateData=function(c){if(c.affected_rows===1){var d={Method:"Update",UserName:this.UserName.GetText(),Password:this.Password.GetText(),DocumentType:this.DocType.GetText(),DocumentNum:this.DocNum.GetText(),Country:this.Country.GetText(),Name:this.Name.GetText(),LastName:this.LastName.GetText(),Phone:this.Phone.GetText(),Email:this.Email.GetText(),Address:this.Address.GetText(),AvatarName:this.Avatar.GetName(),AvatarType:this.Avatar.GetType()};this.Rpc.Send(d,this.UpdateResponse.bind(this))}};b.prototype.UpdateResponse=function(c){if(c.affected_rows===1){this.Reset()}else{console.log("Error: updating user")}};b.prototype.Delete=function(){this.Rpc.Send({Method:"Delete",UserName:this.UserName.GetText()},this.DeleteMedia.bind(this))};b.prototype.DeleteMedia=function(c){if(c.affected_rows===1){var d=new Gwt.Core.Rpc("/media/");d.Send({Method:"Delete",Name:this.Avatar.GetName(),Type:this.Avatar.GetType()},this.DeleteResponse.bind(this))}else{console.log("Error: deleting user")}};b.prototype.DeleteResponse=function(c){this.Reset()};b.prototype.Reset=function(){this.Avatar.Reset();this.UserName.SetText("");this.Password.SetText("");this.DocType.SetText("");this.DocNum.SetText("");this.Country.SetText("");this.Name.SetText("");this.LastName.SetText("");this.Phone.SetText("");this.Email.SetText("");this.Address.SetText("")};return new function(){this.open=function(){if(a===undefined){a=new b();a.Open()}else{console.log("%app open".replace("%app",a.__proto__.constructor.name))}};this.close=function(){if(a!==undefined){a.Close();a=undefined}}}})();